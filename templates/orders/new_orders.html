{% extends "base/base.html" %}
{% load static %}

{% block page_content %}
    <link rel="stylesheet" href="{% static 'css/orders/previous_month_orders.css' %}">

    <div class="orders-container">
        <h1>Поръчки от последните 7 дни</h1>
        <p>
            Период: {{ from_date }} – {{ to_date }}
        </p>

        <p><strong>Обща сума за периода:</strong> {{ total_revenue }} лв.</p>

        {% if orders %}
            <table class="orders-table">
                <thead>
                <tr>
                    <th>#</th>
                    <th>ID</th>
                    <th>Клиент</th>
                    <th>Адрес</th>
                    <th>Дата</th>
                    <th>Приета</th>
                    <th>Изпратена</th>
                    <th>Обща сума на поръчка</th>
                    <th>Действия</th>
                </tr>
                </thead>
                <tbody>
                {% for order in orders %}
                    <tr>
                        <td>{{ forloop.counter }}</td>
                        <td><a href="{% url 'order_detail' pk=order.pk %}">{{ order.pk }}</a></td>
                        <td>{{ order.full_name }}</td>
                        <td>{{ order.address|linebreaksbr }}</td>
                        <td>{{ order.created_at }}</td>
                        <td>
                            {% if order.is_accepted %}
                                <span class="status-True">✔ Да</span>
                            {% else %}
                                <span class="status-False">✖ Не</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if order.is_sent %}
                                <span class="status-True">✔ Да</span>
                            {% else %}
                                <span class="status-False">✖ Не</span>
                            {% endif %}
                        </td>
                        <td>{{ order.total_price }} лв.</td>
                        <td>
                            <a href="{% url 'order edit' pk=order.pk %}" class="btn-edit">Edit</a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>

            {% if is_paginated %}
                <div class="pagination">
                    {% if page_obj.has_previous %}
                        <a href="?page={{ page_obj.previous_page_number }}">Назад</a>
                    {% endif %}
                    <span>
                    Страница {{ page_obj.number }} от {{ page_obj.paginator.num_pages }}
                </span>
                    {% if page_obj.has_next %}
                        <a href="?page={{ page_obj.next_page_number }}">Напред</a>
                    {% endif %}
                </div>
            {% endif %}
        {% else %}
            <p>Няма поръчки за последните 7 дни.</p>
        {% endif %}
    </div>
{% endblock %}
